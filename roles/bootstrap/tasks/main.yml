---
- name: Ensure ~/.ssh exists
  ansible.builtin.file:
    path: "{{ ansible_facts['env']['HOME'] }}/.ssh"
    state: directory
    mode: "0700"

- name: Ensure common directories exist
  ansible.builtin.file:
    path: "{{ ansible_facts['env']['HOME'] }}/{{ item }}"
    state: directory
    mode: "0755"
  loop: "{{ bootstrap_common_directories }}"

- name: Configure Git user name (if set)
  community.general.git_config:
    name: user.name
    scope: global
    value: "{{ bootstrap_git_user_name }}"
  when: bootstrap_git_user_name | length > 0

- name: Configure Git user email (if set)
  community.general.git_config:
    name: user.email
    scope: global
    value: "{{ bootstrap_git_user_email }}"
  when: bootstrap_git_user_email | length > 0

- name: Configure Git default branch
  community.general.git_config:
    name: init.defaultBranch
    scope: global
    value: main

- name: Configure Git pull strategy
  community.general.git_config:
    name: pull.rebase
    scope: global
    value: "false"
